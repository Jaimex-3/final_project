sequenceDiagram
    participant P as Proctor
    participant UI as Web Interface
    participant API as Backend Server
    participant DB as Database
    participant FS as File Storage
    
    Note over P,FS: Violation Recording Workflow
    
    P->>UI: Click "Record Violation" for student
    UI->>API: GET /check-in/{check_in_id}
    API->>DB: SELECT * FROM check_ins WHERE check_in_id=X
    DB-->>API: Return check-in record
    
    API->>DB: SELECT * FROM students WHERE student_id=Y
    DB-->>API: Return student info
    
    API-->>UI: Return student info + check-in details
    UI-->>P: Display violation form with student context
    
    P->>UI: Select violation type (e.g., UNAUTHORIZED_MATERIALS)
    P->>UI: Select severity (LOW/MEDIUM/HIGH)
    P->>UI: Enter description
    
    alt Evidence Photo Available
        P->>UI: Upload evidence photo
        Note over P,UI: Optional evidence attachment
    end
    
    P->>UI: Click "Submit Violation"
    
    UI->>API: POST /violations<br/>{check_in_id, type, severity, description, photo}
    
    alt Photo Uploaded
        API->>FS: Save evidence photo
        FS-->>API: Return file path
    end
    
    API->>DB: INSERT INTO violations<br/>(check_in_id, exam_id, student_id,<br/>reported_by, violation_type, severity,<br/>description, evidence_photo_path,<br/>reported_at, status='RECORDED')
    DB-->>API: Return violation_id
    
    API->>DB: INSERT INTO audit_logs<br/>(user_id, action_type='violation_recorded',<br/>table_name='violations', record_id=violation_id,<br/>new_value=JSON, ip_address, timestamp)
    DB-->>API: Confirm audit log
    
    API-->>UI: Return success + violation_id
    UI-->>P: Display "Violation Recorded Successfully"<br/>Show violation ID and timestamp
    
    Note over P,FS: Violation workflow complete
